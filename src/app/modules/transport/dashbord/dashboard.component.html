<div class="dashboard-container">
    <h2 class="title">Gestion Transport</h2>

    <section class="section" *ngIf="!selectedCompanyId">
        <div class="horizontal-scroll">
            <div *ngFor="let c of companies" class="company-card" (click)="c.id && selectCompany(c.id)">

                <div class="logo-wrapper">
                    <img *ngIf="c.logoUrl" [src]="'http://localhost:8080' + c.logoUrl" class="company-logo"
                        [alt]="c.name">

                    <div *ngIf="!c.logoUrl" class="logo-placeholder">
                        {{ c.name ? c.name.charAt(0).toUpperCase() : '?' }}
                    </div>
                </div>

                <span class="company-name">{{ c.name }}</span>
            </div>
        </div>
    </section>

    <section class="section" style="margin-top: 10px;" *ngIf="selectedCompany">

        <button class="btn-back" (click)="deselectCompany()">
            ‚¨ÖÔ∏è Voir toutes les compagnies
        </button>

        <div class="company-info-card">
            <div class="info-header">
                <div class="header-main">
                    <img *ngIf="selectedCompany.logoUrl" [src]="'http://localhost:8080' + selectedCompany.logoUrl"
                        class="detail-logo">
                    <h4>D√©tails de {{ selectedCompany.name }}</h4>
                </div>

                <div class="header-actions">
                    <span class="badge">{{ selectedCompany.country }}</span>
                    <button [routerLink]="['/edit-company', selectedCompany.id]" class="btn-edit-gear"
                        title="Modifier la compagnie">
                        ‚öôÔ∏è
                    </button>
                </div>
            </div>

            <div class="info-body">
                <div class="info-group">
                    <label>üìû Contact</label>
                    <p>{{ selectedCompany.phone }}</p>
                </div>
                <div class="info-group" *ngIf="selectedCompany.businessNumber">
                    <label>üÜî Registre</label>
                    <p>{{ selectedCompany.businessNumber }}</p>
                </div>
                <div class="info-group">
                    <label>üìç Pays</label>
                    <p>{{ selectedCompany.country }}</p>
                </div>
            </div>
        </div>

        <div class="header-row">
            <h3>V√©hicules de la flotte</h3>
            <div class="actions">
                <span class="count" *ngIf="selectedVehicles.length > 0">
                    {{ selectedVehicles.length }} v√©hicule(s)
                </span>
                <button [routerLink]="['/register-vehicle', selectedCompanyId]" class="btn-add">
                    + Ajouter
                </button>
            </div>
        </div>

        <div class="vehicle-list" *ngIf="selectedVehicles.length > 0">
            <div class="vehicle-item" *ngFor="let v of selectedVehicles">
                <div class="v-img-container">
                    <img *ngIf="v.imageUrl" [src]="'http://localhost:8080' + v.imageUrl" class="v-img" [alt]="v.model">
                    <div *ngIf="!v.imageUrl" class="v-img-placeholder">üöå</div>
                </div>

                <div class="v-info">
                    <strong>{{ v.type || 'V√©hicule' }} - {{ v.model }}</strong>
                    <span>Matricule: {{ v.plateNumber }}</span>
                    <small>Capacit√©: {{ v.capacity }} places</small>
                </div>

                <div class="v-status" [class.available]="v.available !== false">
                    {{ v.available !== false ? 'En service' : 'Hors service' }}
                </div>

                <div class="v-actions">
                <button [routerLink]="['/edit-vehicle', v.id]" class="btn-edit-small" title="Modifier">
                    ‚úèÔ∏è
                </button>
                <button (click)="v.id && deleteVehicle(v.id)" class="btn-delete-small" title="Supprimer">
                    üóëÔ∏è
                </button>
                </div>
            </div>
        </div>

        <div class="empty-state" *ngIf="selectedVehicles.length === 0">
            <p>Aucun v√©hicule enregistr√© pour cette soci√©t√©.</p>
            <button [routerLink]="['/register-vehicle', selectedCompanyId]" class="btn-link">
                Enregistrer le premier v√©hicule
            </button>
        </div>
    </section>
</div>